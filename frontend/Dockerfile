FROM node:16
RUN mkdir -p /usr/src/app
WORKDIR /usr/src/app
# update and install dependency
RUN apt update && apt upgrade -y

# copy the app, note .dockerignore
COPY package.json /usr/src/app/

RUN npm install
RUN npm run build

COPY . /usr/src/app

EXPOSE 3001
ENV NUXT_PORT=3001

# Configure host
ENV HOST 0.0.0.0

CMD [ "npm", "run", "start" ]